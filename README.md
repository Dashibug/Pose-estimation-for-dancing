# ğŸ•º **DancePose: Real-Time Dance Similarity System**

Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğ¹ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞºĞ° Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ñ ÑÑ‚Ğ°Ğ»Ğ¾Ğ½Ğ½Ñ‹Ğ¼ Ñ‚Ğ°Ğ½Ñ†ĞµĞ¼ Ğ¿Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾.  
Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ YOLOv8 Pose Ğ´Ğ»Ñ Ğ¸Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ñ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ñ… Ñ‚Ğ¾Ñ‡ĞµĞº, CTR-GCN Encoder Ğ´Ğ»Ñ ÑĞ¼Ğ±ĞµĞ´Ğ´Ğ¸Ğ½Ğ³Ğ¾Ğ² Ğ¿Ğ¾Ğ· Ğ¸ metric-based similarity Ğ´Ğ»Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ¸ ÑÑ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸ Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğ¹.

---

## ğŸŒŸ Overview

**DancePose** Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¿Ğ¾Ğ·Ñ‹ Ğ¸Ğ· Ğ²Ğ¸Ğ´ĞµĞ¾ Ğ¸ ĞºĞ°Ğ¼ĞµÑ€Ñ‹ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸, Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ÑÑ ÑÑ‚ĞµĞ¿ĞµĞ½ÑŒ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶ĞµÑÑ‚Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ²Ğ°ÑˆĞ¸Ğ¼ Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸ĞµĞ¼ Ğ¸ ÑÑ‚Ğ°Ğ»Ğ¾Ğ½Ğ¾Ğ¼.

<div align="center">
  <img src="[file:///Users/dashitsybikzhapov/Downloads/gtipasd.gif](https://drive.google.com/file/d/1Lb1kVDweTzHXJhZL92GWNgRvWnO01TdQ/view?usp=share_link)" width="700"/>
  <br>
  <em>Left: Your movement in real-time | Right: Reference dance</em>
</div>

---

## ğŸ§  ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

```text
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚        Reference Video        â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                        YOLOv8 Pose (17Ã—3)
                               â”‚
                        CTR-GCN Encoder
                               â”‚
                         embeddings_ref
                               â”‚
                               â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚          Similarity          â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â–²
                               â”‚
                         embeddings_live
                               â”‚
                        CTR-GCN Encoder
                               â”‚
                        YOLOv8 Pose (17Ã—3)
                               â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚         Live Camera          â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš¦ ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¿Ğ°Ğ¹Ğ¿Ğ»Ğ°Ğ¹Ğ½ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°

Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚, Ğ¿Ğ°ĞºĞµÑ‚Ğ½Ğ°Ñ Ğ¿Ğ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° ÑÑ‚Ğ°Ğ»Ğ¾Ğ½Ğ¾Ğ², Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ `.npz`, Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ metric-head (triplet), Ğ·Ğ°Ğ¿ÑƒÑĞº realtime-ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ.

### âœ… Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- Python â‰¥ 3.10
- PyTorch â‰¥ 2.1
- OpenCV
- Ultralytics (YOLOv8 Pose)
- tqdm, numpy

Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°:
```bash
pip install -r requirements.txt
```

## ğŸ§© Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹

|             Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚               |                    ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ                  |                         ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°                      |
|:---------------------------------|:-----------------------------------------------|:------------------------------------------------------------|
| `scripts/extract_from_video.py` | Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ· Ğ¸Ğ· Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ğ´ĞµĞ¾ â†’ `.npz` | `python -m scripts.extract_from_video --video path/to.mp4 --out data/sessions/name.npz` |
| `scripts/build_ref_library.py` | ĞŸĞ°ĞºĞµÑ‚Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ²Ğ¸Ğ´ĞµĞ¾/npz â†’ ĞµĞ´Ğ¸Ğ½Ğ°Ñ Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ° ÑÑ‚Ğ°Ğ»Ğ¾Ğ½Ğ¾Ğ² | `python -m scripts.build_ref_library --src data/ref_videos --out data/ref/library.npz` |
| `scripts/preview_npz.py` | Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾Ğ³Ğ¾ `.npz` (Ñ„Ğ¾Ñ€Ğ¼Ğ°, FPS, Ğ´Ğ»Ğ¸Ğ½Ğ°, Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ) | `python -m scripts.preview_npz --npz data/sessions/name.npz` |
| `scripts/train_triplet.py` | ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ metric-head / CTR-GCN-Ñ‚ÑĞ½Ğ¸Ğ½Ğ³Ğ° Ñ triplet loss | `python -m scripts.train_triplet --config default.yaml` |
| `scripts/realtime_compare.py` | Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ (ĞºĞ°Ğ¼ĞµÑ€Ğ° + ÑÑ‚Ğ°Ğ»Ğ¾Ğ½/Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ°) | `python -m scripts.realtime_compare --ref data/ref/library.npz` |

