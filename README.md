
DancePose ‚Äî —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è —á–µ–ª–æ–≤–µ–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º —Ç–∞–Ω—Ü–µ–º –ø–æ –≤–∏–¥–µ–æ.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è YOLOv8 Pose –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫,
CTR-GCN encoder –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –ø–æ–∑,
–∏ metric-based similarity (triplet loss) –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø–æ—Ö–æ–∂–µ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏–π.

üì∏ Demo
<div align="center"> <img src="https://github.com/yourusername/DancePose/assets/demo.gif" width="700"/> </div>

Left: Reference dance | Right: Your movement in real-time

video (ref) ‚îÄ‚ñ∂ YOLOv8-Pose ‚îÄ‚ñ∂ keypoints (17√ó3) ‚îÄ‚ñ∂ CTR-GCN Encoder ‚îÄ‚ñ∂ embeddings_ref
camera (live) ‚îÄ‚ñ∂ YOLOv8-Pose ‚îÄ‚ñ∂ keypoints (17√ó3) ‚îÄ‚ñ∂ CTR-GCN Encoder ‚îÄ‚ñ∂ embeddings_live
                                               ‚îÇ
                                               ‚ñº
                                    Similarity Score (exp(-‚ÄñŒîemb‚Äñ))

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

–ú–æ–¥—É–ª—å	–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
src/pose/extractor_yolo.py	–ò–∑–≤–ª–µ–∫–∞–µ—Ç 17-—Ç–æ—á–µ—á–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ —á–µ–ª–æ–≤–µ–∫–∞ –∏–∑ –≤–∏–¥–µ–æ / –∫–∞–º–µ—Ä—ã
src/models/encoder_ctrgcn.py	–ì—Ä–∞—Ñ-—Å–≤–µ—Ä—Ç–æ—á–Ω—ã–π —ç–Ω–∫–æ–¥–µ—Ä (CTR-GCN) –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–æ–∑—ã –≤ –≤–∏–¥–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞
scripts/extract_reference.py	–°–æ–∑–¥–∞—ë—Ç .npz –∏–∑ —ç—Ç–∞–ª–æ–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ
scripts/realtime_compare.py	–ó–∞–ø—É—Å–∫–∞–µ—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ: –∫–∞–º–µ—Ä–∞ + —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –≤–∏–¥–µ–æ –±–æ–∫-–æ-–±–æ–∫
src/utils/viz.py	–û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Å–∫–µ–ª–µ—Ç–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ö–æ–¥—Å—Ç–≤–∞

Dependencies:

Python ‚â• 3.10

PyTorch ‚â• 2.1

OpenCV

Ultralytics (YOLOv8 Pose)

tqdm, numpy


Usage
1Ô∏è‚É£ –ò–∑–≤–ª–µ—á—å –∫–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏ –∏–∑ —ç—Ç–∞–ª–æ–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ
python -m scripts.extract_reference --video path/to/ref_dance.mp4


–†–µ–∑—É–ª—å—Ç–∞—Ç:
data/sessions/ref_dance.npz —Å –ø–æ–ª–µ–º kpts —Ñ–æ—Ä–º—ã (T,17,3).

2Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

(–∫–∞–º–µ—Ä–∞ + —ç—Ç–∞–ª–æ–Ω)

python -m scripts.realtime_compare


üîπ –õ–µ–≤–æ–µ –æ–∫–Ω–æ ‚Äî —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –≤–∏–¥–µ–æ
üîπ –ü—Ä–∞–≤–æ–µ –æ–∫–Ω–æ ‚Äî –≤–∞—à–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –Ω–∞–ª–æ–∂–µ–Ω–Ω—ã–º —Å–∫–µ–ª–µ—Ç–æ–º
üîπ –°–≤–µ—Ä—Ö—É –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ—Ö–æ–∂–µ—Å—Ç–∏ (0.0‚Äì1.0)

–ù–∞–∂–º–∏—Ç–µ Q –¥–ª—è –≤—ã—Ö–æ–¥–∞.

üì¶ Project Structure
DancePose/
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ sessions/            # .npz —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Ç–æ—á–∫–∞–º–∏ —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –≤–∏–¥–µ–æ
‚îÇ   ‚îî‚îÄ‚îÄ models/              # —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (encoder.pt)
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ extract_reference.py # –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ø–æ–∑—ã –∏–∑ –≤–∏–¥–µ–æ
‚îÇ   ‚îú‚îÄ‚îÄ realtime_compare.py  # —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤ real-time
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ encoder_ctrgcn.py   # GCN encoder
‚îÇ   ‚îú‚îÄ‚îÄ pose/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ extractor_yolo.py   # YOLOv8 Pose extractor
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ viz.py              # –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–∫–µ–ª–µ—Ç–∞
‚îÇ       ‚îî‚îÄ‚îÄ dataset.py          # —Ä–∞–±–æ—Ç–∞ —Å –æ–∫–Ω–∞–º–∏ –∫–∞–¥—Ä–æ–≤
‚îÇ
‚îî‚îÄ‚îÄ README.md

üß© Example Output
üé• Dual-view: [left] reference   [right] realtime pose
Similarity: 0.83