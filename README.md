# üï∫ **DancePose: Real-Time Dance Similarity System**

> –°–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏–π —á–µ–ª–æ–≤–µ–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º —Ç–∞–Ω—Ü–µ–º –ø–æ –≤–∏–¥–µ–æ.  
> –ò—Å–ø–æ–ª—å–∑—É–µ—Ç YOLOv8 Pose –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–ª—é—á–µ–≤—ã—Ö —Ç–æ—á–µ–∫, CTR-GCN Encoder –¥–ª—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –ø–æ–∑ –∏ metric-based similarity –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Å—Ö–æ–∂–µ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏–π.

---

## üåü Overview

**DancePose** –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–∑—ã –∏–∑ –≤–∏–¥–µ–æ –∏ –∫–∞–º–µ—Ä—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏, –≤—ã—á–∏—Å–ª—è—è —Å—Ç–µ–ø–µ–Ω—å –ø–æ—Ö–æ–∂–µ—Å—Ç–∏ –º–µ–∂–¥—É –≤–∞—à–∏–º –¥–≤–∏–∂–µ–Ω–∏–µ–º –∏ —ç—Ç–∞–ª–æ–Ω–æ–º.

<div align="center">
  <img src="https://github.com/yourusername/DancePose/assets/demo.gif" width="700"/>
  <br>
  <em>Left: Reference dance | Right: Your movement in real-time</em>
</div>

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```text
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ        Reference Video        ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ
                        YOLOv8 Pose (17√ó3)
                               ‚îÇ
                        CTR-GCN Encoder
                               ‚îÇ
                         embeddings_ref
                               ‚îÇ
                               ‚ñº
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ         Similarity           ‚îÇ
                ‚îÇ exp(-‚ÄñŒîembeddings‚Äñ) ‚àà [0,1]  ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚ñ≤
                               ‚îÇ
                         embeddings_live
                               ‚îÇ
                        CTR-GCN Encoder
                               ‚îÇ
                        YOLOv8 Pose (17√ó3)
                               ‚îÇ
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ         Live Camera          ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò


## üö¶ –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω –∑–∞–ø—É—Å–∫–∞

> –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç, –ø–∞–∫–µ—Ç–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —ç—Ç–∞–ª–æ–Ω–æ–≤, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è `.npz`, –æ–±—É—á–µ–Ω–∏–µ metric-head (triplet), –∑–∞–ø—É—Å–∫ realtime-—Å—Ä–∞–≤–Ω–µ–Ω–∏—è.

### ‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python ‚â• 3.10
- PyTorch ‚â• 2.1
- OpenCV
- Ultralytics (YOLOv8 Pose)
- tqdm, numpy

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
pip install -r requirements.txt

## üß© –°–∫—Ä–∏–ø—Ç—ã

| –°–∫—Ä–∏–ø—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ |
|:---------------------------------|:-----------------------------------------------|:------------------------------------------------------------|
| `scripts/extract_from_video.py` | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–æ–∑ –∏–∑ –æ–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ ‚Üí `.npz` | `python -m scripts.extract_from_video --video path/to.mp4 --out data/sessions/name.npz` |
| `scripts/build_ref_library.py` | –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ/npz ‚Üí –µ–¥–∏–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —ç—Ç–∞–ª–æ–Ω–æ–≤ | `python -m scripts.build_ref_library --src data/ref_videos --out data/ref/library.npz` |
| `scripts/preview_npz.py` | –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ `.npz` (—Ñ–æ—Ä–º–∞, FPS, –¥–ª–∏–Ω–∞, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è) | `python -m scripts.preview_npz --npz data/sessions/name.npz` |
| `scripts/train_triplet.py` | –û–±—É—á–µ–Ω–∏–µ metric-head / CTR-GCN-—Ç—é–Ω–∏–Ω–≥–∞ —Å triplet loss | `python -m scripts.train_triplet --config default.yaml` |
| `scripts/realtime_compare.py` | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–∫–∞–º–µ—Ä–∞ + —ç—Ç–∞–ª–æ–Ω/–±–∏–±–ª–∏–æ—Ç–µ–∫–∞) | `python -m scripts.realtime_compare --ref data/ref/library.npz` |

